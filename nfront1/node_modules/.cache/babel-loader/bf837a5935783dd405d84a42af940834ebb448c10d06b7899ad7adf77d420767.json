{"ast":null,"code":"/*!\n * router\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2022 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n * @private\n */\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/web.immediate.js\");\nvar debug = require('debug')('router:route');\nvar flatten = require('array-flatten').flatten;\nvar Layer = require('./layer');\nvar methods = require('methods');\n\n/**\n * Module variables.\n * @private\n */\n\nvar slice = Array.prototype.slice;\n\n/* istanbul ignore next */\nvar defer = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n  process.nextTick(fn.bind.apply(fn, arguments));\n};\n\n/**\n * Expose `Route`.\n */\n\nmodule.exports = Route;\n\n/**\n * Initialize `Route` with the given `path`,\n *\n * @param {String} path\n * @api private\n */\n\nfunction Route(path) {\n  debug('new %o', path);\n  this.path = path;\n  this.stack = [];\n\n  // route handlers for various http methods\n  this.methods = Object.create(null);\n}\n\n/**\n * @private\n */\n\nRoute.prototype._handles_method = function _handles_method(method) {\n  if (this.methods._all) {\n    return true;\n  }\n\n  // normalize name\n  var name = typeof method === 'string' ? method.toLowerCase() : method;\n  if (name === 'head' && !this.methods['head']) {\n    name = 'get';\n  }\n  return Boolean(this.methods[name]);\n};\n\n/**\n * @return {array} supported HTTP methods\n * @private\n */\n\nRoute.prototype._methods = function _methods() {\n  var methods = Object.keys(this.methods);\n\n  // append automatic head\n  if (this.methods.get && !this.methods.head) {\n    methods.push('head');\n  }\n  for (var i = 0; i < methods.length; i++) {\n    // make upper case\n    methods[i] = methods[i].toUpperCase();\n  }\n  return methods;\n};\n\n/**\n * dispatch req, res into this route\n *\n * @private\n */\n\nRoute.prototype.dispatch = function dispatch(req, res, done) {\n  var idx = 0;\n  var stack = this.stack;\n  var sync = 0;\n  if (stack.length === 0) {\n    return done();\n  }\n  var method = typeof req.method === 'string' ? req.method.toLowerCase() : req.method;\n  if (method === 'head' && !this.methods['head']) {\n    method = 'get';\n  }\n  req.route = this;\n  next();\n  function next(err) {\n    // signal to exit route\n    if (err && err === 'route') {\n      return done();\n    }\n\n    // signal to exit router\n    if (err && err === 'router') {\n      return done(err);\n    }\n\n    // no more matching layers\n    if (idx >= stack.length) {\n      return done(err);\n    }\n\n    // max sync stack\n    if (++sync > 100) {\n      return defer(next, err);\n    }\n    var layer;\n    var match;\n\n    // find next matching layer\n    while (match !== true && idx < stack.length) {\n      layer = stack[idx++];\n      match = !layer.method || layer.method === method;\n    }\n\n    // no match\n    if (match !== true) {\n      return done(err);\n    }\n    if (err) {\n      layer.handle_error(err, req, res, next);\n    } else {\n      layer.handle_request(req, res, next);\n    }\n    sync = 0;\n  }\n};\n\n/**\n * Add a handler for all HTTP verbs to this route.\n *\n * Behaves just like middleware and can respond or call `next`\n * to continue processing.\n *\n * You can use multiple `.all` call to add multiple handlers.\n *\n *   function check_something(req, res, next){\n *     next()\n *   }\n *\n *   function validate_user(req, res, next){\n *     next()\n *   }\n *\n *   route\n *   .all(validate_user)\n *   .all(check_something)\n *   .get(function(req, res, next){\n *     res.send('hello world')\n *   })\n *\n * @param {array|function} handler\n * @return {Route} for chaining\n * @api public\n */\n\nRoute.prototype.all = function all(handler) {\n  var callbacks = flatten(slice.call(arguments));\n  if (callbacks.length === 0) {\n    throw new TypeError('argument handler is required');\n  }\n  for (var i = 0; i < callbacks.length; i++) {\n    var fn = callbacks[i];\n    if (typeof fn !== 'function') {\n      throw new TypeError('argument handler must be a function');\n    }\n    var layer = Layer('/', {}, fn);\n    layer.method = undefined;\n    this.methods._all = true;\n    this.stack.push(layer);\n  }\n  return this;\n};\nmethods.forEach(function (method) {\n  Route.prototype[method] = function (handler) {\n    var callbacks = flatten(slice.call(arguments));\n    if (callbacks.length === 0) {\n      throw new TypeError('argument handler is required');\n    }\n    for (var i = 0; i < callbacks.length; i++) {\n      var fn = callbacks[i];\n      if (typeof fn !== 'function') {\n        throw new TypeError('argument handler must be a function');\n      }\n      debug('%s %s', method, this.path);\n      var layer = Layer('/', {}, fn);\n      layer.method = method;\n      this.methods[method] = true;\n      this.stack.push(layer);\n    }\n    return this;\n  };\n});","map":{"version":3,"names":["require","debug","flatten","Layer","methods","slice","Array","prototype","defer","setImmediate","fn","process","nextTick","bind","apply","arguments","module","exports","Route","path","stack","Object","create","_handles_method","method","_all","name","toLowerCase","Boolean","_methods","keys","get","head","push","i","length","toUpperCase","dispatch","req","res","done","idx","sync","route","next","err","layer","match","handle_error","handle_request","all","handler","callbacks","call","TypeError","undefined","forEach"],"sources":["C:/Users/31136/node_modules/router/lib/route.js"],"sourcesContent":["/*!\n * router\n * Copyright(c) 2013 Roman Shtylman\n * Copyright(c) 2014-2022 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar debug = require('debug')('router:route')\nvar flatten = require('array-flatten').flatten\nvar Layer = require('./layer')\nvar methods = require('methods')\n\n/**\n * Module variables.\n * @private\n */\n\nvar slice = Array.prototype.slice\n\n/* istanbul ignore next */\nvar defer = typeof setImmediate === 'function'\n  ? setImmediate\n  : function (fn) { process.nextTick(fn.bind.apply(fn, arguments)) }\n\n/**\n * Expose `Route`.\n */\n\nmodule.exports = Route\n\n/**\n * Initialize `Route` with the given `path`,\n *\n * @param {String} path\n * @api private\n */\n\nfunction Route(path) {\n  debug('new %o', path)\n  this.path = path\n  this.stack = []\n\n  // route handlers for various http methods\n  this.methods = Object.create(null)\n}\n\n/**\n * @private\n */\n\nRoute.prototype._handles_method = function _handles_method(method) {\n  if (this.methods._all) {\n    return true\n  }\n\n  // normalize name\n  var name = typeof method === 'string'\n    ? method.toLowerCase()\n    : method\n\n  if (name === 'head' && !this.methods['head']) {\n    name = 'get'\n  }\n\n  return Boolean(this.methods[name])\n}\n\n/**\n * @return {array} supported HTTP methods\n * @private\n */\n\nRoute.prototype._methods = function _methods() {\n  var methods = Object.keys(this.methods)\n\n  // append automatic head\n  if (this.methods.get && !this.methods.head) {\n    methods.push('head')\n  }\n\n  for (var i = 0; i < methods.length; i++) {\n    // make upper case\n    methods[i] = methods[i].toUpperCase()\n  }\n\n  return methods\n}\n\n/**\n * dispatch req, res into this route\n *\n * @private\n */\n\nRoute.prototype.dispatch = function dispatch(req, res, done) {\n  var idx = 0\n  var stack = this.stack\n  var sync = 0\n\n  if (stack.length === 0) {\n    return done()\n  }\n\n  var method = typeof req.method === 'string'\n    ? req.method.toLowerCase()\n    : req.method\n\n  if (method === 'head' && !this.methods['head']) {\n    method = 'get'\n  }\n\n  req.route = this\n\n  next()\n\n  function next(err) {\n    // signal to exit route\n    if (err && err === 'route') {\n      return done()\n    }\n\n    // signal to exit router\n    if (err && err === 'router') {\n      return done(err)\n    }\n\n    // no more matching layers\n    if (idx >= stack.length) {\n      return done(err)\n    }\n\n    // max sync stack\n    if (++sync > 100) {\n      return defer(next, err)\n    }\n\n    var layer\n    var match\n\n    // find next matching layer\n    while (match !== true && idx < stack.length) {\n      layer = stack[idx++]\n      match = !layer.method || layer.method === method\n    }\n\n    // no match\n    if (match !== true) {\n      return done(err)\n    }\n\n    if (err) {\n      layer.handle_error(err, req, res, next)\n    } else {\n      layer.handle_request(req, res, next)\n    }\n\n    sync = 0\n  }\n}\n\n/**\n * Add a handler for all HTTP verbs to this route.\n *\n * Behaves just like middleware and can respond or call `next`\n * to continue processing.\n *\n * You can use multiple `.all` call to add multiple handlers.\n *\n *   function check_something(req, res, next){\n *     next()\n *   }\n *\n *   function validate_user(req, res, next){\n *     next()\n *   }\n *\n *   route\n *   .all(validate_user)\n *   .all(check_something)\n *   .get(function(req, res, next){\n *     res.send('hello world')\n *   })\n *\n * @param {array|function} handler\n * @return {Route} for chaining\n * @api public\n */\n\nRoute.prototype.all = function all(handler) {\n  var callbacks = flatten(slice.call(arguments))\n\n  if (callbacks.length === 0) {\n    throw new TypeError('argument handler is required')\n  }\n\n  for (var i = 0; i < callbacks.length; i++) {\n    var fn = callbacks[i]\n\n    if (typeof fn !== 'function') {\n      throw new TypeError('argument handler must be a function')\n    }\n\n    var layer = Layer('/', {}, fn)\n    layer.method = undefined\n\n    this.methods._all = true\n    this.stack.push(layer)\n  }\n\n  return this\n}\n\nmethods.forEach(function (method) {\n  Route.prototype[method] = function (handler) {\n    var callbacks = flatten(slice.call(arguments))\n\n    if (callbacks.length === 0) {\n      throw new TypeError('argument handler is required')\n    }\n\n    for (var i = 0; i < callbacks.length; i++) {\n      var fn = callbacks[i]\n\n      if (typeof fn !== 'function') {\n        throw new TypeError('argument handler must be a function')\n      }\n\n      debug('%s %s', method, this.path)\n\n      var layer = Layer('/', {}, fn)\n      layer.method = method\n\n      this.methods[method] = true\n      this.stack.push(layer)\n    }\n\n    return this\n  }\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}